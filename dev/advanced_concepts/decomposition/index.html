<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Decomposition · SpineOpt.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">SpineOpt.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../getting_started/installation/">Installation</a></li><li><a class="tocitem" href="../../getting_started/running_an_optimization/">Running an Optimization</a></li><li><a class="tocitem" href="../../getting_started/creating_your_own_model/">Creating Your Own Model</a></li></ul></li><li><span class="tocitem">Concept Reference</span><ul><li><a class="tocitem" href="../../concept_reference/the_basics/">Basics of the model structure</a></li><li><a class="tocitem" href="../../concept_reference/Object Classes/">Object Classes</a></li><li><a class="tocitem" href="../../concept_reference/Relationship Classes/">Relationship Classes</a></li><li><a class="tocitem" href="../../concept_reference/Parameters/">Parameters</a></li><li><a class="tocitem" href="../../concept_reference/Parameter Value Lists/">Parameter Value Lists</a></li></ul></li><li><span class="tocitem">Mathematical Formulation</span><ul><li><a class="tocitem" href="../../mathematical_formulation/sets/">Sets</a></li><li><a class="tocitem" href="../../mathematical_formulation/variables/">Variables</a></li><li><a class="tocitem" href="../../mathematical_formulation/constraints/">Constraints</a></li><li><a class="tocitem" href="../../mathematical_formulation/objective_function/">Objective</a></li></ul></li><li><span class="tocitem">Advanced Concepts</span><ul><li><a class="tocitem" href="../temporal_framework/">Temporal Framework</a></li><li><a class="tocitem" href="../stochastic_framework/">Stochastic Framework</a></li><li><a class="tocitem" href="../investment_optimization/">Investment Optimization</a></li><li><a class="tocitem" href="../unit_commitment/">Unit Commitment</a></li><li><a class="tocitem" href="../ramping_and_reserves/">Ramping and reserves</a></li></ul></li><li><a class="tocitem" href="../../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Decomposition</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Decomposition</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Spine-project/SpineOpt.jl/blob/master/docs/src/advanced_concepts/decomposition.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Decomposition-1"><a class="docs-heading-anchor" href="#Decomposition-1">Decomposition</a><a class="docs-heading-anchor-permalink" href="#Decomposition-1" title="Permalink"></a></h1><p>Decomposition approaches take advantage of certain problem structures to separate them into multiple related problems which are each more easily solved. Decomposition also allows us to do the inverse, which is to combine independent problems into a single problem, where each can be solved separately but with communication between them (e.g. investments and operations problems)</p><p>Decomposition thus allows us to do a number of things</p><ul><li>Solve larger problems which are otherwise intractable</li><li>Include more detail in problems which otherwise need to be simplified</li><li>Combine related problems (e.g. investments/operations) in a more scientific way (rather than ad-hoc).</li><li>Employ parallel computing methods to solve multiple problems simultaneously.</li></ul><h2 id="High-level-Decomposition-Algorithm-1"><a class="docs-heading-anchor" href="#High-level-Decomposition-Algorithm-1">High-level Decomposition Algorithm</a><a class="docs-heading-anchor-permalink" href="#High-level-Decomposition-Algorithm-1" title="Permalink"></a></h2><p>The high-level algorithm works as follows:</p><ul><li>Model initialisation (preprocess<em>data</em>structure, generate temporal structures etc.)</li><li>For each benders_iteration<ul><li>Solve master problem</li><li>Process master-problem solution:<ul><li>set units<em>invested</em>bi(unit=u, benders_iteration=bi) equal to a timeseries representing the investment variables solution from the master problem</li></ul></li><li>Rewind and update operations problem</li><li>Solve operations problem loop</li><li>Process operations sub-problem<ul><li>set units<em>available</em>mw(unit=u, benders<em>iteration=bi) equal to a timeseries representing the marginal value of the units</em>on bound constraint</li></ul></li><li>Test for convergence</li><li>Update master problem<ul><li>Add Benders cuts constraints (constraint<em>mp</em>units<em>invested</em>cuts)</li></ul></li><li>Next benders iteration</li></ul></li></ul><h2 id="Duals-calculation-for-decomposition-1"><a class="docs-heading-anchor" href="#Duals-calculation-for-decomposition-1">Duals calculation for decomposition</a><a class="docs-heading-anchor-permalink" href="#Duals-calculation-for-decomposition-1" title="Permalink"></a></h2><p>The <code>optimize_model!()</code> function has been updated to optionally include an additional step for the calculation of duals. The dual solution to a MIP problem is not well defined. The standard approach to obtaining marginal values from a MIP model is to relax the integer variables, fix them to their last solution value and re-solve the problem as an LP. This is the standard approach in energy system modelling to obtain energy prices. However, although this is the standard approach, it does need to be used with caution (see here for example). The main hazard associated with inferring duals in this way is that the impact on costs of an investment may be overstated. However, since these duals are used in Benders decomposition to obtain a lower bound on costs (i.e. the maximum potential value from an investment), this is ok and can be &quot;corrected&quot; in the next iteration. And finally, the benders gap will tell us how close our decomposed problem is to the optimal global solution.</p><p>This additional relaxed LP solve is done as follows:</p><ul><li><code>add_varialbe!()</code> stores the list of integer and binary variables in <code>m.ext[:integer_variables]</code></li><li>the <code>fix_value</code> for integer variables is set to the last MIP solution value</li><li>the integer constraints on the integer variables are <code>unset()</code></li><li>A final LP is solved</li><li>required dual values are saved</li><li>integer constraints on integer variables are <code>set()</code></li></ul><p>This final fixed LP solve is trigged by specifying <code>calculate_duals=true</code> in the call to <code>optimize_model!()</code></p><h2 id="Reporting-dual-values:-1"><a class="docs-heading-anchor" href="#Reporting-dual-values:-1">Reporting dual values:</a><a class="docs-heading-anchor-permalink" href="#Reporting-dual-values:-1" title="Permalink"></a></h2><p>To report the dual of a constraint, one can add an output item with the corresponding constraint name (e.g. <code>constraint_nodal_balance</code>) and add that to a report. This will cause the corresponding constraint&#39;s relaxed problem marginal value will be reported in the output DB. When adding a constraint name as an output we need to preface the actual constraint name with &quot;constraint<em>&quot; to avoid ambiguity with variable names (e.g. `units</em>available<code>). So to report the marginal value of</code>units<em>available` we add an output object called &quot;constraint</em>units_available&quot;.</p><p>To report the <code>reduced_cost()</code> for a variable which is the marginal value of the associated active bound or fix constraints on that variable, one can add an output object with the variable name prepended by &quot;bound<em>&quot;. So, to report the units</em>on reduced<em>cost value, one would create an output item called &quot;bound</em>units<em>on&quot;. If added to a report, this will cause the reduced cost of units</em>on in the final fixed LP to be written to the output db. Finally, if any constraint duals or reduced<em>cost values are requested via a report, calculate</em>duals is set to true and the final fixed LP solve is triggered.</p><h2 id="Using-Decomposition-1"><a class="docs-heading-anchor" href="#Using-Decomposition-1">Using Decomposition</a><a class="docs-heading-anchor-permalink" href="#Using-Decomposition-1" title="Permalink"></a></h2><p>The decomposition framework creates a master problem where the investment variables are optimised. The decomposition framework is invoked when a model object with the parameter <code>model_type</code> set to <code>:spineopt_operations</code> is found and a second model object with <code>model_type</code> set to <code>:spineopt_master</code>. Once these conditions are met, all investment decisions in the model are automatically decomposed and optimised in the master problem. This behavriour may change in the future to allow some investment decisions to be optimised in the operations problem and some optimised in the master problem as desired.</p><p>Additionally, the following should be specified:  </p><ul><li>master problem <code>model</code> parameter, <code>max_gap</code> - This determines the master problem convergence criterion for the relative benders gap</li><li>master problem <code>model</code> <code>max_iterations</code> - This determines the master problem convergence criterion for the number of iterations  - </li><li><code>model_report</code>: relationship which determines which reports are written for which model</li></ul><pre><code class="language-none"></code></pre></article></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 15 April 2021 13:07">Thursday 15 April 2021</span>. Using Julia version 1.6.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
